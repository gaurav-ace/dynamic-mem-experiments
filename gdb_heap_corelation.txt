Temporary breakpoint 1, main () at custom_mem_alloc_app.cpp:6
6           int *p = (int *)my_malloc(sizeof(int));
(gdb) n
7           *p = 30;
(gdb)
8           std::cout << sizeof(BlockHeader) << ", " << sizeof(BlockHeader*) << "\n";
(gdb)
24, 8
9           std::cout << sizeof(size_t) << ", " << sizeof(bool) << "\n";
(gdb)
8, 1
10          std::cout << p << " -> "<< *p << "\n";
(gdb)
0x555555558178 -> 30
11          my_free(p);
(gdb)
13          p = new int(); // this internally calls custom operator new, size is known by type (compiler deduces this).
(gdb) x/40gx heap
0x555555558160 <_ZL4heap>:      0x0000000000000004      0x0000000000000001
0x555555558170 <_ZL4heap+16>:   0x00005555555581d8      0x000000000000001e
0x555555558180 <_ZL4heap+32>:   0x0000000000000000      0x0000000000000000
0x555555558190 <_ZL4heap+48>:   0x0000000000000000      0x0000000000000000
0x5555555581a0 <_ZL4heap+64>:   0x0000000000000000      0x0000000000000000
0x5555555581b0 <_ZL4heap+80>:   0x0000000000000000      0x0000000000000000
0x5555555581c0 <_ZL4heap+96>:   0x0000000000000000      0x0000000000000000
0x5555555581d0 <_ZL4heap+112>:  0x0000000000000000      0x00000000000fffcc
0x5555555581e0 <_ZL4heap+128>:  0x0000000000000001      0x0000000000000000
0x5555555581f0 <_ZL4heap+144>:  0x0000000000000000      0x0000000000000000
0x555555558200 <_ZL4heap+160>:  0x0000000000000000      0x0000000000000000
0x555555558210 <_ZL4heap+176>:  0x0000000000000000      0x0000000000000000
0x555555558220 <_ZL4heap+192>:  0x0000000000000000      0x0000000000000000
0x555555558230 <_ZL4heap+208>:  0x0000000000000000      0x0000000000000000
0x555555558240 <_ZL4heap+224>:  0x0000000000000000      0x0000000000000000
0x555555558250 <_ZL4heap+240>:  0x0000000000000000      0x0000000000000000
0x555555558260 <_ZL4heap+256>:  0x0000000000000000      0x0000000000000000
0x555555558270 <_ZL4heap+272>:  0x0000000000000000      0x0000000000000000
0x555555558280 <_ZL4heap+288>:  0x0000000000000000      0x0000000000000000
0x555555558290 <_ZL4heap+304>:  0x0000000000000000      0x0000000000000000
(gdb) n
15          *p = 31;
(gdb) x/40gx heap
0x555555558160 <_ZL4heap>:      0x0000000000000004      0x0000000000000001
0x555555558170 <_ZL4heap+16>:   0x00005555555581d8      0x000000000000001e
0x555555558180 <_ZL4heap+32>:   0x0000000000000000      0x0000000000000000
0x555555558190 <_ZL4heap+48>:   0x0000000000000000      0x0000000000000000
0x5555555581a0 <_ZL4heap+64>:   0x0000000000000000      0x0000000000000000
0x5555555581b0 <_ZL4heap+80>:   0x0000000000000000      0x0000000000000000
0x5555555581c0 <_ZL4heap+96>:   0x0000000000000000      0x0000000000000000
0x5555555581d0 <_ZL4heap+112>:  0x0000000000000000      0x0000000000000004
0x5555555581e0 <_ZL4heap+128>:  0x0000000000000000      0x0000555555558250
0x5555555581f0 <_ZL4heap+144>:  0x0000000000000000      0x0000000000000000
0x555555558200 <_ZL4heap+160>:  0x0000000000000000      0x0000000000000000
0x555555558210 <_ZL4heap+176>:  0x0000000000000000      0x0000000000000000
0x555555558220 <_ZL4heap+192>:  0x0000000000000000      0x0000000000000000
0x555555558230 <_ZL4heap+208>:  0x0000000000000000      0x0000000000000000
0x555555558240 <_ZL4heap+224>:  0x0000000000000000      0x0000000000000000
0x555555558250 <_ZL4heap+240>:  0x00000000000fffb0      0x0000000000000001
0x555555558260 <_ZL4heap+256>:  0x0000000000000000      0x0000000000000000
0x555555558270 <_ZL4heap+272>:  0x0000000000000000      0x0000000000000000
0x555555558280 <_ZL4heap+288>:  0x0000000000000000      0x0000000000000000
0x555555558290 <_ZL4heap+304>:  0x0000000000000000      0x0000000000000000
(gdb) n
16          std::cout << p << " -> "<< *p << "\n";
(gdb) x/40gx heap
0x555555558160 <_ZL4heap>:      0x0000000000000004      0x0000000000000001
0x555555558170 <_ZL4heap+16>:   0x00005555555581d8      0x000000000000001e
0x555555558180 <_ZL4heap+32>:   0x0000000000000000      0x0000000000000000
0x555555558190 <_ZL4heap+48>:   0x0000000000000000      0x0000000000000000
0x5555555581a0 <_ZL4heap+64>:   0x0000000000000000      0x0000000000000000
0x5555555581b0 <_ZL4heap+80>:   0x0000000000000000      0x0000000000000000
0x5555555581c0 <_ZL4heap+96>:   0x0000000000000000      0x0000000000000000
0x5555555581d0 <_ZL4heap+112>:  0x0000000000000000      0x0000000000000004
0x5555555581e0 <_ZL4heap+128>:  0x0000000000000000      0x0000555555558250
0x5555555581f0 <_ZL4heap+144>:  0x000000000000001f      0x0000000000000000
0x555555558200 <_ZL4heap+160>:  0x0000000000000000      0x0000000000000000
0x555555558210 <_ZL4heap+176>:  0x0000000000000000      0x0000000000000000
0x555555558220 <_ZL4heap+192>:  0x0000000000000000      0x0000000000000000
0x555555558230 <_ZL4heap+208>:  0x0000000000000000      0x0000000000000000
0x555555558240 <_ZL4heap+224>:  0x0000000000000000      0x0000000000000000
0x555555558250 <_ZL4heap+240>:  0x00000000000fffb0      0x0000000000000001
0x555555558260 <_ZL4heap+256>:  0x0000000000000000      0x0000000000000000
0x555555558270 <_ZL4heap+272>:  0x0000000000000000      0x0000000000000000
0x555555558280 <_ZL4heap+288>:  0x0000000000000000      0x0000000000000000
0x555555558290 <_ZL4heap+304>:  0x0000000000000000      0x0000000000000000
(gdb) n
0x5555555581f0 -> 31
17          delete p;  // this internally calls desctructor of data type and then call custom operator delete
(gdb) n
19          return 0;
(gdb) x/40gx heap
0x555555558160 <_ZL4heap>:      0x0000000000000004      0x0000000000000001
0x555555558170 <_ZL4heap+16>:   0x00005555555581d8      0x000000000000001e
0x555555558180 <_ZL4heap+32>:   0x0000000000000000      0x0000000000000000
0x555555558190 <_ZL4heap+48>:   0x0000000000000000      0x0000000000000000
0x5555555581a0 <_ZL4heap+64>:   0x0000000000000000      0x0000000000000000
0x5555555581b0 <_ZL4heap+80>:   0x0000000000000000      0x0000000000000000
0x5555555581c0 <_ZL4heap+96>:   0x0000000000000000      0x0000000000000000
0x5555555581d0 <_ZL4heap+112>:  0x0000000000000000      0x0000000000000004
0x5555555581e0 <_ZL4heap+128>:  0x0000000000000001      0x0000555555558250
0x5555555581f0 <_ZL4heap+144>:  0x000000000000001f      0x0000000000000000
0x555555558200 <_ZL4heap+160>:  0x0000000000000000      0x0000000000000000
0x555555558210 <_ZL4heap+176>:  0x0000000000000000      0x0000000000000000
0x555555558220 <_ZL4heap+192>:  0x0000000000000000      0x0000000000000000
0x555555558230 <_ZL4heap+208>:  0x0000000000000000      0x0000000000000000
0x555555558240 <_ZL4heap+224>:  0x0000000000000000      0x0000000000000000
0x555555558250 <_ZL4heap+240>:  0x00000000000fffb0      0x0000000000000001
0x555555558260 <_ZL4heap+256>:  0x0000000000000000      0x0000000000000000
0x555555558270 <_ZL4heap+272>:  0x0000000000000000      0x0000000000000000
0x555555558280 <_ZL4heap+288>:  0x0000000000000000      0x0000000000000000
0x555555558290 <_ZL4heap+304>:  0x0000000000000000      0x0000000000000000
(gdb) q

